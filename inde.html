<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Will You Marry Me? ‚ù§Ô∏è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        :root {
            --primary-color: #ff4081;
            --secondary-color: #f50057;
            --accent-color: #ff79b0;
            --light-bg: #fff5f7;
            --dark-bg: #1a1a2e;
            --light-text: #333;
            --dark-text: #f1f1f1;
            --card-bg-light: #ffffff;
            --card-bg-dark: #162447;
            --shadow-light: 0 8px 32px rgba(255, 64, 129, 0.1);
            --shadow-dark: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        body.light-mode {
            background: linear-gradient(135deg, #fff5f7 0%, #ffeef2 100%);
            color: var(--light-text);
        }

        body.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #162447 100%);
            color: var(--dark-text);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            position: relative;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        #themeBtn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(255, 64, 129, 0.3);
            transition: transform 0.3s;
            font-family: 'Poppins', sans-serif;
        }

        #themeBtn:hover {
            transform: translateY(-2px);
        }

        section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .active-section {
            display: block;
        }

        .hidden-section {
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .heart-animation {
            text-align: center;
            margin: 30px 0;
        }

        .heart-animation i {
            font-size: 100px;
            color: var(--primary-color);
            animation: heartbeat 1.5s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .title {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            text-align: center;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .subtitle {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: var(--secondary-color);
            font-family: 'Poppins', sans-serif;
        }

        .buttons {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 50px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-family: 'Poppins', sans-serif;
        }

        .yes-btn {
            background: linear-gradient(45deg, #ff4081, #ff79b0);
            color: white;
            box-shadow: 0 8px 25px rgba(255, 64, 129, 0.4);
        }

        .yes-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 30px rgba(255, 64, 129, 0.6);
        }

        .no-btn {
            background: linear-gradient(45deg, #6c757d, #adb5bd);
            color: white;
            box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
        }

        .no-btn:hover {
            transform: translateY(-5px);
        }

        .message {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            border-radius: 15px;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        body.light-mode .message {
            background: #ffeef2;
            border: 2px solid var(--primary-color);
        }

        body.dark-mode .message {
            background: #1f4068;
            border: 2px solid var(--accent-color);
        }

        .hidden {
            display: none;
        }

        .success-animation {
            text-align: center;
            margin: 30px 0;
        }

        .success-animation i {
            font-size: 100px;
            color: #4CAF50;
            animation: successPulse 2s infinite;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .love-message {
            text-align: center;
            font-size: 1.3rem;
            margin: 30px auto;
            max-width: 800px;
            line-height: 1.6;
            padding: 20px;
            border-radius: 15px;
            font-family: 'Poppins', sans-serif;
        }

        body.light-mode .love-message {
            background: rgba(255, 64, 129, 0.1);
        }

        body.dark-mode .love-message {
            background: rgba(255, 121, 176, 0.1);
        }

        .gallery-section, .quotes-gallery, .messages-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: 20px;
        }

        body.light-mode .gallery-section,
        body.light-mode .quotes-gallery,
        body.light-mode .messages-container {
            background: var(--card-bg-light);
            box-shadow: var(--shadow-light);
        }

        body.dark-mode .gallery-section,
        body.dark-mode .quotes-gallery,
        body.dark-mode .messages-container {
            background: var(--card-bg-dark);
            box-shadow: var(--shadow-dark);
        }

        .upload-area {
            margin: 30px 0;
            text-align: center;
        }

        .upload-box {
            border: 3px dashed var(--primary-color);
            border-radius: 20px;
            padding: 40px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .upload-box:hover {
            background: rgba(255, 64, 129, 0.1);
            transform: translateY(-5px);
        }

        .upload-box i {
            font-size: 50px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .upload-box p {
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-family: 'Poppins', sans-serif;
        }

        #imageUpload {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }

        .upload-note {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #666;
            font-family: 'Poppins', sans-serif;
        }

        body.dark-mode .upload-note {
            color: #aaa;
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .gallery img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 15px;
            transition: transform 0.3s;
            cursor: pointer;
        }

        .gallery img:hover {
            transform: scale(1.05);
        }

        .quote-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .quote-btn, .add-btn {
            padding: 12px 30px;
            font-size: 1rem;
        }

        .quote-btn {
            background: linear-gradient(45deg, #2196F3, #21CBF3);
        }

        .add-btn {
            background: linear-gradient(45deg, #FF9800, #FFB74D);
        }

        .quote-display {
            margin: 40px 0;
            text-align: center;
        }

        .quote-box {
            padding: 40px;
            border-radius: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        body.light-mode .quote-box {
            background: linear-gradient(135deg, #ffeef2, #fff5f7);
            border: 2px solid var(--primary-color);
        }

        body.dark-mode .quote-box {
            background: linear-gradient(135deg, #1f4068, #162447);
            border: 2px solid var(--accent-color);
        }

        .quote-text {
            font-size: 1.5rem;
            font-style: italic;
            margin-bottom: 20px;
            line-height: 1.6;
            font-family: 'Poppins', sans-serif;
        }

        .quote-author {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
            font-family: 'Poppins', sans-serif;
        }

        .form-container {
            margin: 30px auto;
            max-width: 600px;
            padding: 30px;
            border-radius: 15px;
        }

        body.light-mode .form-container {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
        }

        body.dark-mode .form-container {
            background: #1f4068;
            border: 1px solid #30475e;
        }

        textarea, input[type="text"] {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-size: 1rem;
            resize: vertical;
            font-family: 'Poppins', sans-serif;
        }

        body.light-mode textarea,
        body.light-mode input[type="text"] {
            background: white;
            color: #333;
        }

        body.dark-mode textarea,
        body.dark-mode input[type="text"] {
            background: #30475e;
            color: white;
            border-color: #405770;
        }

        .form-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .submit-btn {
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            flex: 2;
        }

        .cancel-btn {
            background: linear-gradient(45deg, #f44336, #ff7961);
            flex: 1;
        }

        .quotes-list {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .quote-item {
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid var(--primary-color);
        }

        body.light-mode .quote-item {
            background: #f8f9fa;
        }

        body.dark-mode .quote-item {
            background: #1f4068;
        }

        .message-form {
            max-width: 600px;
            margin: 30px auto;
        }

        .message-btn {
            background: linear-gradient(45deg, #9C27B0, #E91E63);
            width: 100%;
            padding: 15px;
            margin-top: 15px;
        }

        .messages-list {
            margin-top: 30px;
        }

        .message-item {
            padding: 20px;
            margin: 15px 0;
            border-radius: 15px;
            position: relative;
            font-family: 'Poppins', sans-serif;
        }

        body.light-mode .message-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
        }

        body.dark-mode .message-item {
            background: #1f4068;
            border: 1px solid #30475e;
        }

        .message-author {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .message-time {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 0.8rem;
            color: #888;
        }

        .nav-menu {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        body.dark-mode .nav-menu {
            background: rgba(26, 26, 46, 0.9);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
        }

        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            background: transparent;
            color: var(--primary-color);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Poppins', sans-serif;
        }

        .nav-btn:hover, .nav-btn.active {
            background: var(--primary-color);
            color: white;
            transform: translateY(-3px);
        }

        #confettiCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .nav-menu {
                width: 90%;
                justify-content: space-around;
                padding: 10px;
            }
            
            .nav-btn span {
                display: none;
            }
            
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }

        .section-subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-family: 'Poppins', sans-serif;
        }

        body.dark-mode .section-subtitle {
            color: #aaa;
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 15px;
        }

        .delete-image {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .gallery-item:hover .delete-image {
            opacity: 1;
        }
    </style>
</head>
<body class="light-mode">
    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button id="themeBtn">
            <i class="fas fa-moon"></i> Dark Mode
        </button>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Proposal Section -->
        <section id="proposal" class="active-section">
            <div class="heart-animation">
                <i class="fas fa-heart"></i>
            </div>
            <h1 class="title">Will You Marry Me?</h1>
            <p class="subtitle">My love for you is infinite ‚ù§Ô∏è</p>
            
            <div class="buttons">
                <button id="yesBtn" class="btn yes-btn">
                    <i class="fas fa-heart"></i> YES! Forever
                </button>
                <button id="noBtn" class="btn no-btn">
                    <i class="fas fa-times"></i> No
                </button>
            </div>
            
            <div id="noMessage" class="message hidden">
                <h2>You'll never say no! ‚ù§Ô∏è</h2>
                <p>Go and click the YES button, my love!</p>
            </div>
        </section>

        <!-- Yes Response Section -->
        <section id="yesResponse" class="hidden-section">
            <div class="success-animation">
                <i class="fas fa-heart-circle-check"></i>
            </div>
            <h1>Thank You For Everything! ‚ù§Ô∏è</h1>
            <p class="love-message">You've made me the happiest person in the world! I promise to love you forever and always.</p>
            
            <!-- Image Gallery -->
            <div class="gallery-section">
                <h2><i class="fas fa-images"></i> Our Memories Gallery</h2>
                <div class="upload-area">
                    <div class="upload-box" id="uploadBox">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Click or drag to upload images</p>
                        <input type="file" id="imageUpload" accept="image/*" multiple>
                    </div>
                    <p class="upload-note">* All visitors can upload images to our gallery</p>
                </div>
                
                <div class="gallery" id="imageGallery">
                    <!-- Images will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Love Letters Section -->
        <section id="loveLetters" class="hidden-section">
            <h1><i class="fas fa-heart"></i> Love Letters & Quotes</h1>
            
            <div class="quote-controls">
                <button id="generateQuote" class="btn quote-btn">
                    <i class="fas fa-magic"></i> Generate Love Quote
                </button>
                <button id="addQuoteBtn" class="btn add-btn">
                    <i class="fas fa-plus"></i> Add Your Quote
                </button>
            </div>
            
            <div class="quote-display">
                <div id="currentQuote" class="quote-box">
                    <p class="quote-text">"Love is not just looking at each other, it's looking in the same direction."</p>
                    <p class="quote-author">‚Äî Antoine de Saint-Exup√©ry</p>
                </div>
            </div>
            
            <!-- Add Quote Form -->
            <div id="addQuoteForm" class="form-container hidden">
                <h3>Share Your Love Quote</h3>
                <textarea id="newQuoteText" placeholder="Write your beautiful love quote here..."></textarea>
                <input type="text" id="quoteAuthor" placeholder="Your name (optional)">
                <div class="form-buttons">
                    <button id="submitQuote" class="btn submit-btn">Submit Quote</button>
                    <button id="cancelQuote" class="btn cancel-btn">Cancel</button>
                </div>
            </div>
            
            <!-- Quotes Gallery -->
            <div class="quotes-gallery">
                <h3><i class="fas fa-quote-left"></i> Shared Love Quotes</h3>
                <div id="quotesList" class="quotes-list">
                    <!-- Quotes will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Messages Section -->
        <section id="messages" class="hidden-section">
            <h1><i class="fas fa-comments"></i> Message Board</h1>
            <p class="section-subtitle">Leave a sweet message for us!</p>
            
            <div class="message-form">
                <input type="text" id="senderName" placeholder="Your name" required>
                <textarea id="messageText" placeholder="Write your sweet message here..." required></textarea>
                <button id="sendMessage" class="btn message-btn">
                    <i class="fas fa-paper-plane"></i> Send Message
                </button>
            </div>
            
            <div class="messages-container">
                <h3><i class="fas fa-history"></i> Recent Messages</h3>
                <div id="messagesList" class="messages-list">
                    <!-- Messages will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Navigation -->
        <nav class="nav-menu">
            <button class="nav-btn active" data-target="proposal">
                <i class="fas fa-home"></i> <span>Home</span>
            </button>
            <button class="nav-btn" data-target="yesResponse" id="navGallery">
                <i class="fas fa-images"></i> <span>Gallery</span>
            </button>
            <button class="nav-btn" data-target="loveLetters">
                <i class="fas fa-heart"></i> <span>Love Letters</span>
            </button>
            <button class="nav-btn" data-target="messages">
                <i class="fas fa-comments"></i> <span>Messages</span>
            </button>
        </nav>
    </div>

    <!-- Confetti Canvas -->
    <canvas id="confettiCanvas"></canvas>

    <script>
        class ValentineWebsite {
            constructor() {
                this.initializeElements();
                this.setupEventListeners();
                this.loadInitialData();
                this.setupConfetti();
                this.currentSection = 'proposal';
            }

            initializeElements() {
                // Buttons
                this.yesBtn = document.getElementById('yesBtn');
                this.noBtn = document.getElementById('noBtn');
                this.themeBtn = document.getElementById('themeBtn');
                this.generateQuoteBtn = document.getElementById('generateQuote');
                this.addQuoteBtn = document.getElementById('addQuoteBtn');
                this.submitQuoteBtn = document.getElementById('submitQuote');
                this.cancelQuoteBtn = document.getElementById('cancelQuote');
                this.sendMessageBtn = document.getElementById('sendMessage');
                
                // Sections
                this.sections = {
                    proposal: document.getElementById('proposal'),
                    yesResponse: document.getElementById('yesResponse'),
                    loveLetters: document.getElementById('loveLetters'),
                    messages: document.getElementById('messages')
                };
                
                // Message displays
                this.noMessage = document.getElementById('noMessage');
                
                // Forms
                this.addQuoteForm = document.getElementById('addQuoteForm');
                this.imageUpload = document.getElementById('imageUpload');
                
                // Containers
                this.imageGallery = document.getElementById('imageGallery');
                this.quotesList = document.getElementById('quotesList');
                this.messagesList = document.getElementById('messagesList');
                this.currentQuote = document.getElementById('currentQuote');
                
                // Inputs
                this.newQuoteText = document.getElementById('newQuoteText');
                this.quoteAuthor = document.getElementById('quoteAuthor');
                this.senderName = document.getElementById('senderName');
                this.messageText = document.getElementById('messageText');
                
                // Navigation
                this.navButtons = document.querySelectorAll('.nav-btn');
                
                // Confetti
                this.canvas = document.getElementById('confettiCanvas');
                this.ctx = this.canvas.getContext('2d');
                
                // Default love quotes
                this.loveQuotes = [
                    {
                        text: "I love you not only for what you are, but for what I am when I am with you.",
                        author: "Elizabeth Barrett Browning"
                    },
                    {
                        text: "You are the finest, loveliest, tenderest, and most beautiful person I have ever known.",
                        author: "F. Scott Fitzgerald"
                    },
                    {
                        text: "I saw that you were perfect, and so I loved you. Then I saw that you were not perfect and I loved you even more.",
                        author: "Angelita Lim"
                    },
                    {
                        text: "Love is composed of a single soul inhabiting two bodies.",
                        author: "Aristotle"
                    },
                    {
                        text: "If I had a flower for every time I thought of you, I could walk in my garden forever.",
                        author: "Alfred Tennyson"
                    },
                    {
                        text: "You are my today and all of my tomorrows.",
                        author: "Leo Christopher"
                    },
                    {
                        text: "I need you like a heart needs a beat.",
                        author: "Unknown"
                    },
                    {
                        text: "My love for you is a journey starting at forever and ending at never.",
                        author: "Unknown"
                    }
                ];
                
                // Sample images for gallery
                this.sampleImages = [
                    'https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    'https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'
                ];
            }

            setupEventListeners() {
                // Proposal buttons
                this.yesBtn.addEventListener('click', () => this.handleYesClick());
                this.noBtn.addEventListener('click', () => this.handleNoClick());
                
                // Theme toggle
                this.themeBtn.addEventListener('click', () => this.toggleTheme());
                
                // Navigation
                this.navButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const target = e.target.closest('.nav-btn').dataset.target;
                        this.switchSection(target);
                    });
                });
                
                // Love letters
                this.generateQuoteBtn.addEventListener('click', () => this.generateRandomQuote());
                this.addQuoteBtn.addEventListener('click', () => this.toggleQuoteForm(true));
                this.submitQuoteBtn.addEventListener('click', () => this.addNewQuote());
                this.cancelQuoteBtn.addEventListener('click', () => this.toggleQuoteForm(false));
                
                // Image upload
                this.imageUpload.addEventListener('change', (e) => this.handleImageUpload(e));
                
                // Messages
                this.sendMessageBtn.addEventListener('click', () => this.sendMessage());
                
                // Handle Enter key in forms
                this.messageText.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
                
                // Initialize on load
                window.addEventListener('load', () => {
                    this.loadTheme();
                    this.generateRandomQuote();
                    this.loadGalleryImages();
                    this.loadQuotes();
                    this.loadMessages();
                    this.resizeCanvas();
                });
                
                // Handle window resize
                window.addEventListener('resize', () => this.resizeCanvas());
                
                // Load data when sections are shown
                document.addEventListener('sectionChanged', (e) => {
                    if (e.detail.section === 'yesResponse') {
                        this.loadGalleryImages();
                    } else if (e.detail.section === 'loveLetters') {
                        this.loadQuotes();
                    } else if (e.detail.section === 'messages') {
                        this.loadMessages();
                    }
                });
            }

            handleYesClick() {
                this.switchSection('yesResponse');
                this.startConfetti();
                this.playSuccessSound();
                
                // Show success message
                setTimeout(() => {
                    alert("üíï You've made me the happiest person in the world! I love you! üíï");
                }, 500);
            }

            handleNoClick() {
                this.noMessage.classList.remove('hidden');
                
                // Move the no button randomly
                const maxX = window.innerWidth - this.noBtn.offsetWidth - 50;
                const maxY = window.innerHeight - this.noBtn.offsetHeight - 150;
                
                const randomX = Math.floor(Math.random() * maxX);
                const randomY = Math.floor(Math.random() * maxY);
                
                this.noBtn.style.position = 'fixed';
                this.noBtn.style.left = `${randomX}px`;
                this.noBtn.style.top = `${randomY}px`;
                
                // Shake animation
                this.noBtn.style.animation = 'shake 0.5s ease';
                setTimeout(() => {
                    this.noBtn.style.animation = '';
                }, 500);
                
                // Play error sound
                this.playErrorSound();
            }

            playSuccessSound() {
                try {
                    // Create success sound using Web Audio API
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                } catch (e) {
                    console.log("Audio not supported");
                }
            }

            playErrorSound() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(150, audioContext.currentTime + 0.1);
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                } catch (e) {
                    console.log("Audio not supported");
                }
            }

            loadTheme() {
                const savedTheme = localStorage.getItem('valentine-theme') || 'light';
                if (savedTheme === 'dark') {
                    document.body.classList.remove('light-mode');
                    document.body.classList.add('dark-mode');
                    this.themeBtn.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                } else {
                    document.body.classList.remove('dark-mode');
                    document.body.classList.add('light-mode');
                    this.themeBtn.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
                }
            }

            toggleTheme() {
                const body = document.body;
                const isDark = body.classList.contains('dark-mode');
                
                if (isDark) {
                    body.classList.remove('dark-mode');
                    body.classList.add('light-mode');
                    this.themeBtn.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
                    localStorage.setItem('valentine-theme', 'light');
                } else {
                    body.classList.remove('light-mode');
                    body.classList.add('dark-mode');
                    this.themeBtn.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                    localStorage.setItem('valentine-theme', 'dark');
                }
            }

            switchSection(sectionName) {
                // Hide all sections
                Object.values(this.sections).forEach(section => {
                    section.classList.remove('active-section');
                    section.classList.add('hidden-section');
                });
                
                // Show target section
                this.sections[sectionName].classList.remove('hidden-section');
                this.sections[sectionName].classList.add('active-section');
                
                // Update navigation buttons
                this.navButtons.forEach(btn => {
                    if (btn.dataset.target === sectionName) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
                
                // Trigger custom event
                document.dispatchEvent(new CustomEvent('sectionChanged', {
                    detail: { section: sectionName }
                }));
                
                this.currentSection = sectionName;
            }

            generateRandomQuote() {
                const quotes = [...this.loveQuotes, ...this.getSavedQuotes()];
                const randomIndex = Math.floor(Math.random() * quotes.length);
                const quote = quotes[randomIndex];
                
                this.currentQuote.innerHTML = `
                    <p class="quote-text">"${quote.text}"</p>
                    <p class="quote-author">‚Äî ${quote.author}</p>
                `;
                
                // Add animation
                this.currentQuote.style.animation = 'fadeIn 0.5s ease';
                setTimeout(() => {
                    this.currentQuote.style.animation = '';
                }, 500);
            }

            toggleQuoteForm(show) {
                if (show) {
                    this.addQuoteForm.classList.remove('hidden');
                    this.newQuoteText.focus();
                } else {
                    this.addQuoteForm.classList.add('hidden');
                    this.newQuoteText.value = '';
                    this.quoteAuthor.value = '';
                }
            }

            addNewQuote() {
                const text = this.newQuoteText.value.trim();
                const author = this.quoteAuthor.value.trim() || 'Anonymous';
                
                if (!text) {
                    alert('Please write a love quote!');
                    return;
                }
                
                const newQuote = {
                    text: text,
                    author: author,
                    timestamp: new Date().toISOString()
                };
                
                // Save to localStorage
                this.saveQuote(newQuote);
                
                // Update display
                this.loadQuotes();
                
                // Reset form
                this.toggleQuoteForm(false);
                
                // Show success message
                alert('Thank you for sharing your beautiful quote! ‚ù§Ô∏è');
                
                // Generate new random quote to include the new one
                this.generateRandomQuote();
            }

            saveQuote(quote) {
                const savedQuotes = JSON.parse(localStorage.getItem('valentineQuotes') || '[]');
                savedQuotes.push(quote);
                localStorage.setItem('valentineQuotes', JSON.stringify(savedQuotes));
            }

            getSavedQuotes() {
                return JSON.parse(localStorage.getItem('valentineQuotes') || '[]');
            }

            async handleImageUpload(event) {
                const files = event.target.files;
                if (!files.length) return;
                
                // For demo purposes, we'll use local storage
                // In a real app, you would upload to a server
                for (let file of files) {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        
                        reader.onload = (e) => {
                            const imageData = e.target.result;
                            this.addImageToGallery(imageData);
                        };
                        
                        reader.readAsDataURL(file);
                    }
                }
                
                // Reset file input
                event.target.value = '';
                
                // Show success message
                alert(`Added ${files.length} image(s) to our gallery! Thank you! ‚ù§Ô∏è`);
            }

            addImageToGallery(imageData) {
                const imageContainer = document.createElement('div');
                imageContainer.className = 'gallery-item';
                
                const img = document.createElement('img');
                img.src = imageData;
                img.alt = 'Memory';
                img.loading = 'lazy';
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-image';
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    if (confirm('Delete this image?')) {
                        imageContainer.remove();
                        this.removeImageFromStorage(imageData);
                    }
                };
                
                imageContainer.appendChild(img);
                imageContainer.appendChild(deleteBtn);
                this.imageGallery.prepend(imageContainer);
                
                // Save to localStorage
                this.saveGalleryImage(imageData);
            }

            saveGalleryImage(imageData) {
                let gallery = JSON.parse(localStorage.getItem('valentineGallery') || '[]');
                gallery.unshift({
                    data: imageData,
                    timestamp: new Date().toISOString()
                });
                
                // Keep only last 50 images
                gallery = gallery.slice(0, 50);
                
                localStorage.setItem('valentineGallery', JSON.stringify(gallery));
            }

            removeImageFromStorage(imageData) {
                let gallery = JSON.parse(localStorage.getItem('valentineGallery') || '[]');
                gallery = gallery.filter(item => item.data !== imageData);
                localStorage.setItem('valentineGallery', JSON.stringify(gallery));
            }

            loadGalleryImages() {
                // Clear gallery
                this.imageGallery.innerHTML = '';
                
                // Load from localStorage
                const gallery = JSON.parse(localStorage.getItem('valentineGallery') || '[]');
                
                // Add sample images if empty
                if (gallery.length === 0) {
                    this.sampleImages.forEach(imgSrc => {
                        const imgContainer = document.createElement('div');
                        imgContainer.className = 'gallery-item';
                        
                        const img = document.createElement('img');
                        img.src = imgSrc;
                        img.alt = 'Sample memory';
                        
                        imgContainer.appendChild(img);
                        this.imageGallery.appendChild(imgContainer);
                    });
                } else {
                    gallery.forEach(item => {
                        const imgContainer = document.createElement('div');
                        imgContainer.className = 'gallery-item';
                        
                        const img = document.createElement('img');
                        img.src = item.data;
                        img.alt = 'Memory';
                        
                        const deleteBtn = document.createElement('button');
                        deleteBtn.className = 'delete-image';
                        deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                        deleteBtn.onclick = (e) => {
                            e.stopPropagation();
                            if (confirm('Delete this image?')) {
                                imgContainer.remove();
                                this.removeImageFromStorage(item.data);
                            }
                        };
                        
                        imgContainer.appendChild(img);
                        imgContainer.appendChild(deleteBtn);
                        this.imageGallery.appendChild(imgContainer);
                    });
                }
            }

            loadQuotes() {
                // Clear quotes list
                this.quotesList.innerHTML = '';
                
                // Load all quotes
                const allQuotes = [...this.loveQuotes, ...this.getSavedQuotes()];
                
                // Display quotes (limit to 20)
                allQuotes.slice(0, 20).forEach((quote, index) => {
                    const quoteElement = document.createElement('div');
                    quoteElement.className = 'quote-item';
                    quoteElement.innerHTML = `
                        <p class="quote-text">"${quote.text}"</p>
                        <p class="quote-author">‚Äî ${quote.author}</p>
                    `;
                    
                    this.quotesList.appendChild(quoteElement);
                });
                
                if (allQuotes.length === 0) {
                    this.quotesList.innerHTML = '<p style="text-align: center; color: #666;">No quotes yet. Be the first to share one!</p>';
                }
            }

            sendMessage() {
                const name = this.senderName.value.trim();
                const message = this.messageText.value.trim();
                
                if (!name || !message) {
                    alert('Please enter both your name and message!');
                    return;
                }
                
                if (message.length > 500) {
                    alert('Message is too long! Please keep it under 500 characters.');
                    return;
                }
                
                const newMessage = {
                    name: name,
                    message: message,
                    timestamp: new Date().toISOString(),
                    time: 'Just now'
                };
                
                // Add to messages list
                this.addMessageToList(newMessage);
                
                // Save to localStorage
                this.saveMessage(newMessage);
                
                // Clear form
                this.senderName.value = '';
                this.messageText.value = '';
                
                // Show success animation
                this.showMessageSuccess();
            }

            addMessageToList(message) {
                const messageElement = document.createElement('div');
                messageElement.className = 'message-item';
                
                // Format time
                const time = this.formatTime(new Date(message.timestamp));
                
                messageElement.innerHTML = `
                    <div class="message-author">${message.name}</div>
                    <div class="message-time">${time}</div>
                    <div class="message-content">${this.escapeHtml(message.message)}</div>
                `;
                
                this.messagesList.prepend(messageElement);
            }

            saveMessage(message) {
                const messages = JSON.parse(localStorage.getItem('valentineMessages') || '[]');
                messages.unshift(message);
                
                // Keep only last 50 messages
                const limitedMessages = messages.slice(0, 50);
                
                localStorage.setItem('valentineMessages', JSON.stringify(limitedMessages));
            }

            loadMessages() {
                // Clear messages list
                this.messagesList.innerHTML = '';
                
                // Load from localStorage
                const messages = JSON.parse(localStorage.getItem('valentineMessages') || '[]');
                
                // Add sample messages if empty
                if (messages.length === 0) {
                    const sampleMessages = [
                        { name: "Sarah", message: "Congratulations! Wishing you both a lifetime of happiness! ‚ù§Ô∏è", timestamp: new Date(Date.now() - 2*60*60*1000).toISOString() },
                        { name: "Michael", message: "So happy for you two! Perfect match! ü•∞", timestamp: new Date(Date.now() - 5*60*60*1000).toISOString() },
                        { name: "Jessica", message: "This is the most beautiful proposal website I've ever seen! üíï", timestamp: new Date(Date.now() - 24*60*60*1000).toISOString() }
                    ];
                    
                    sampleMessages.forEach(msg => this.addMessageToList(msg));
                } else {
                    messages.forEach(msg => this.addMessageToList(msg));
                }
            }

            formatTime(date) {
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMs / 3600000);
                const diffDays = Math.floor(diffMs / 86400000);
                
                if (diffMins < 1) return 'Just now';
                if (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`;
                if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
                if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
                
                return date.toLocaleDateString();
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            showMessageSuccess() {
                const successMsg = document.createElement('div');
                successMsg.className = 'message-item';
                successMsg.style.background = 'linear-gradient(45deg, #4CAF50, #8BC34A)';
                successMsg.style.color = 'white';
                successMsg.innerHTML = '<i class="fas fa-check-circle"></i> Message sent successfully!';
                
                this.messagesList.prepend(successMsg);
                
                setTimeout(() => {
                    successMsg.style.opacity = '0';
                    successMsg.style.transition = 'opacity 0.5s';
                    setTimeout(() => successMsg.remove(), 500);
                }, 2000);
            }

            // Confetti System
            resizeCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }

            setupConfetti() {
                this.resizeCanvas();
                this.confettiParticles = [];
                this.confettiColors = ['#ff4081', '#f50057', '#ff79b0', '#2196F3', '#4CAF50', '#FF9800'];
            }

            startConfetti() {
                this.createConfetti();
                this.animateConfetti();
                
                // Stop confetti after 5 seconds
                setTimeout(() => {
                    this.stopConfetti();
                }, 5000);
            }

            stopConfetti() {
                this.confettiParticles = [];
            }

            createConfetti() {
                for (let i = 0; i < 150; i++) {
                    this.confettiParticles.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height - this.canvas.height,
                        r: Math.random() * 10 + 5,
                        d: Math.random() * 10 + 5,
                        color: this.confettiColors[Math.floor(Math.random() * this.confettiColors.length)],
                        tilt: Math.floor(Math.random() * 10) - 10,
                        tiltAngleIncremental: Math.random() * 0.07 + 0.05,
                        tiltAngle: 0
                    });
                }
            }

            animateConfetti() {
                if (this.confettiParticles.length === 0) return;
                
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                for (let i = 0; i < this.confettiParticles.length; i++) {
                    const p = this.confettiParticles[i];
                    
                    // Update particle position
                    p.tiltAngle += p.tiltAngleIncremental;
                    p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2;
                    p.x += Math.sin(p.d);
                    p.tilt = Math.sin(p.tiltAngle) * 15;
                    
                    // Draw particle
                    this.ctx.beginPath();
                    this.ctx.lineWidth = p.r / 2;
                    this.ctx.strokeStyle = p.color;
                    this.ctx.moveTo(p.x + p.tilt + p.r / 4, p.y);
                    this.ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r / 4);
                    this.ctx.stroke();
                    
                    // Reset particle if it goes off screen
                    if (p.x > this.canvas.width + 20 || p.x < -20 || p.y > this.canvas.height) {
                        if (i % 5 > 0) {
                            this.confettiParticles[i] = {
                                x: Math.random() * this.canvas.width,
                                y: -20,
                                r: p.r,
                                d: p.d,
                                color: p.color,
                                tilt: p.tilt,
                                tiltAngleIncremental: p.tiltAngleIncremental,
                                tiltAngle: p.tiltAngle
                            };
                        }
                    }
                }
                
                requestAnimationFrame(() => this.animateConfetti());
            }

            loadInitialData() {
                // Load initial data if not exists
                if (!localStorage.getItem('valentineMessages')) {
                    const initialMessages = [
                        {
                            name: "Sarah",
                            message: "Congratulations! Wishing you both a lifetime of happiness! ‚ù§Ô∏è",
                            timestamp: new Date(Date.now() - 2*60*60*1000).toISOString()
                        },
                        {
                            name: "Michael",
                            message: "So happy for you two! Perfect match! ü•∞",
                            timestamp: new Date(Date.now() - 5*60*60*1000).toISOString()
                        }
                    ];
                    localStorage.setItem('valentineMessages', JSON.stringify(initialMessages));
                }
            }
        }

        // Initialize the website when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.valentineApp = new ValentineWebsite();
        });
    </script>
</body>
</html>
